<?xml version="1.0" encoding="utf-8"?>
<openerp>
  <data>

    <record id="ir_cron_scheduler_sale_order" model="ir.cron">
      <field name="name">sale_order_sch_daily</field>
      <field name="interval_number">1</field>
      <field name="interval_type">days</field>
      <field name="numbercall">-1</field>
      <field name="doall" eval="True"/>
      <field name="model">sale.order</field>
      <field name="function">_cancel_expired_quotation</field>
      <field name="args">()</field>
    </record>

    <record model="ir.ui.view" id="sale.view_quotation_custum_tree">
      <field name="name">date limit de validité</field>
      <field name="model">sale.order</field>
      <field name="inherit_id" ref="sale.view_quotation_tree"/>
      <field name="arch" type="xml">
	<xpath expr="//field[@name='date_order']" position="after">
	  <!-- <filter string="Expired Quotation" filter_domain="[('valid_until', '&lt;', context_today()), ('state', 'ilike', 'cancel')]" /> -->
	  <field name="valid_until"/>
	</xpath>
      </field>
    </record>



    <!-- explicit list view definition -->

    <record model="ir.ui.view" id="saleLimitValid.field">
      <field name="name">date limit field</field>
      <field name="model">sale.order</field>
      <field name="inherit_id" ref="sale.view_order_form"/>
      <field name="arch" type="xml">
        <!-- find field description and add the field
             valid_until it -->
	<xpath expr="//field[@name='date_order']" position="after">
          <field name="valid_duration"/>
        </xpath>
	<!-- <xpath expr="//field[@name='date_order']" position="after"> -->
        <!--   <field name="today"/> -->
        <!-- </xpath> -->
	<xpath expr="//field[@name='date_order']" position="after">
          <field name="valid_until" string="Limite de Validité"/>
        </xpath>
      </field>
    </record>

    <record model="ir.ui.view" id="saleLimitValid.configfield">
      <field name="name">date limit config field</field>
      <field name="model">sale.config.settings</field>
      <field name="inherit_id" ref="sale.view_sales_config"/>
      <field name="arch" type="xml">
        <!-- find field description and add the field
             valid_until it -->
        <xpath expr="//div[@name='Sale Features']" position="inside">
	  <div name="module_quotation_validity">
	    <label for="validation_duration"/>
	    <field name="default_valid_duration" class="oe_inline"/>
	  </div>
        </xpath>
      </field>
    </record>

  </data>
</openerp>
